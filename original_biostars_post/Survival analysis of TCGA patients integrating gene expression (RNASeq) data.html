<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <link rel="shortcut icon" href="https://www.biostars.org/static/favicon.ico">

    <title>
    Survival analysis of TCGA patients integrating gene expression (RNASeq) data
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/bootstrap.css" rel="stylesheet">
    <link href="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/font-awesome.css" rel="stylesheet">

    <script type="text/javascript" async="" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/ga.js"></script><script async="" type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/gpt.js"></script><script src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/jquery.js"></script>
    <script src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/bootstrap.js"></script>

    
    

        
        <link rel="stylesheet" href="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/a263178e5ed2.css" type="text/css">

        <script type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/6f945e6b21cf.js"></script>

    

    

    <script type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/Markdown_002.js"></script>
    <script type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/Markdown_003.js"></script>
    <script type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/Markdown.js"></script>

    
    <link rel="stylesheet" href="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/markdown.css">



    <script type="text/javascript">
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') +
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script><script src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/pubads_impl_108.js" async=""></script>

<script type="text/javascript">
googletag.cmd.push(function() {
googletag.pubads().collapseEmptyDivs(true);
googletag.defineSlot('/64550467/special_sidebar', [220, 250], 'special_sidebar').addService(googletag.pubads());
googletag.defineSlot('/64550467/Leaderboard', [728, 90], 'div-gpt-ad-1412001329349-0').addService(googletag.pubads());
googletag.defineSlot('/64550467/Sidebar-220x250', [220, 250], 'div-gpt-ad-1412001329349-1').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
googletag.enableServices();
});
</script>


    <script type="application/javascript">
        
            USER_ID = 30846;
        
        TITLE_SEARCH_URL = "/local/search/title/"
        POST_DISPLAY_URL = "/p/"
    </script>
<link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-5/html/container.html"></head>
<body>

<div class="container" id="content">

    
    
    


<div class="row visible-lg visible-md">
    <div class="col-md-12 text-center" id="topnav">
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Latest/">Latest</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Open/">Open</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/RNA-Seq/">RNA-Seq</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/ChIP-Seq/">ChIP-Seq</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/SNP/">SNP</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Assembly/">Assembly</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Tutorials/">Tutorials</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Tools/">Tools</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Jobs/">Jobs</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="https://www.biostars.org/t/Forum/">Forum</a>
                </div>
            
            <div class="col-md-1 "><a href="https://www.biostars.org/planet/">Planet</a></div>
            <div class="col-md-1 "><a href="https://www.biostars.org/t/">All »</a></div>
        
    </div>
</div>

<div class="row visible-sm visible-xs">

    <div class="col-xs-4">
        <div class="btn-group">
            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                 View Posts 
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
                
                    <li>
                        <a href="https://www.biostars.org/t/Latest">Latest</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Open">Open</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/RNA-Seq">RNA-Seq</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/ChIP-Seq">ChIP-Seq</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/SNP">SNP</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Assembly">Assembly</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Tutorials">Tutorials</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Tools">Tools</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Jobs">Jobs</a>
                    </li>
                
                    <li>
                        <a href="https://www.biostars.org/t/Forum">Forum</a>
                    </li>
                
                <li><a href="https://www.biostars.org/planet/">Planet</a></li>
                <li><a href="https://www.biostars.org/t/">All »</a></li>
            </ul>
        </div>
    </div>

        <div class="col-xs-4 text-center" style="margin-bottom:5px">
        <a role="button" class="btn btn-primary" href="https://www.biostars.org/">
            <i class="fa fa-star fa-1x"></i> Home </a>
        

    </div>

    <div class="col-xs-4 ">
        <div class="btn-group pull-right">

            
                <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">
                    <i class="fa fa-user"></i> You <span class="badge"></span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li>
                        <a href="https://www.biostars.org/t/myposts/"><i class="fa fa-comments"></i> My Posts</a>
                    </li>
                    <li>
                        <a href="https://www.biostars.org/local/messages/"><i class="fa fa-envelope"></i> My Messages
                            <span class="badge"></span> </a>
                    </li>
                    <li>
                        <a href="https://www.biostars.org/t/bookmarks/"><i class="fa fa-book"></i> My Bookmarks</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="https://www.biostars.org/p/new/post/"><i class="fa fa-plus"></i> New Post</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="https://www.biostars.org/site/logout/"><i class="fa fa-sign-out"></i> Log Out</a>
                    </li>
                </ul>
            
        </div>
    </div>
</div>


<div class="row visible-lg visible-md">

    <div class="col-md-12" id="navbar">

        <div class="col-lg-3 visible-lg" id="logo">
            <a href="https://www.biostars.org/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/biostar2.png"></a>
        </div>

        <div class="col-md-3 visible-md text-center">
            <a href="https://www.biostars.org/">
                </a><a href="https://www.biostars.org/"><img style="width:200px; height: auto;" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/biostar2.png"></a>
            
        </div>

        

            <div class="col-md-9 top ">

                <i class="fa fa-user"></i> 


<a href="https://www.biostars.org/u/30846/">mforde84</a> • <b>320</b> &nbsp;|&nbsp;
                <a href="https://www.biostars.org/site/logout/"><i class="fa fa-sign-out"></i> Logout </a>

                <span class="pull-right">
                    <a href="https://www.biostars.org/info/about/">about</a> • <a href="https://www.biostars.org/info/faq/">faq</a>
                    • <a href="https://www.biostars.org/info/rss/">rss <i class="fa fa-rss"></i></a>
                </span>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/user/list/">
                    <div><i class="fa fa-globe"></i>
                    </div>
                    <div>Community</div>
                </a>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/local/messages/">
                    <div><i class="fa fa-envelope"></i>
                    </div>
                    <div>Messages</div>
                </a>
                <span class="badge"></span>
            </div>

            <div class="col-sm-1 mid ">

                <a href="https://www.biostars.org/local/votes/" class="navitem">
                    <div class="navitem">
                        <div><i class="fa fa-heart"></i></div>
                        <div> Votes</div>
                    </div>
                </a>
                <span class="badge"></span>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/t/myposts/" class="navitem">
                    <div><i class="fa fa-comments"></i></div>
                    <div>My Posts</div>
                </a>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/t/mytags/" class="navitem">
                    <div><i class="fa fa-tag"></i></div>
                    <div>My Tags</div>
                </a>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/t/following/" class="navitem">
                    <div><i class="fa fa-eye"></i></div>
                    <div>Following</div>
                </a>
            </div>

            <div class="col-sm-1 mid ">
                <a href="https://www.biostars.org/t/bookmarks/" class="navitem">
                    <div><i class="fa fa-book"></i></div>
                    <div>Bookmarks</div>
                </a>
            </div>

            <div class="col-sm-1 mid newpost pull-right">
                <a href="https://www.biostars.org/p/new/post/" class="navitem">
                    <div><i class="fa fa-plus-circle"></i></div>
                    <div>New Post</div>
                </a>
            </div>

        
    </div>
</div>


    

    
    

    
    

    

    <div class="row" itemscope="" itemtype="http://schema.org/QAPage">

        <div class="col-xs-12 col-md-9">

            <div id="post-details">
                
                <span itemscope="" itemtype="http://schema.org/Question">
                    

<div class="post-body Open clearfix">


    
        



        <div class="title">Tutorial: <span itemprop="name">Survival analysis of TCGA patients integrating gene expression (RNASeq) data</span></div>

    

    <div class="post vote-box visible-lg visible-md" data-post_id="153013">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">66</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="153013"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/13278/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/41e47f5f2c8d7d18b21ec1d157e63315.png" alt="gravatar for TriS"></a></div>
        <div class="ago">18 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b> wrote:</div>
</div>

            <span itemprop="text"><p>I found myself being often confused
 about how to do this and by various posts and tutorials online I 
realized that, if I could put together a step-by-step tutorial, that 
might be (hopefully) useful...so there we go.</p>

<p>first question: why would you want to do survival analysis based on 
gene expression data? well, let's say you have a number of genes that 
you are interested in and they are differentially expressed between 
tumor and normal samples, it would be very powerful to show that 
alteration in gene expression correlates with worse survival or earlier 
tumor recurrence.</p>

<p>here’s a brief overview of what’s in here:<br>
1) obtain the data (RNASeq and clinical data)<br>
2) prepare the data for the analysis<br>
3) run the analysis and interpret the results</p>

<p>in this tutorial I will be using data from kidney cancer (clear cell renal cell carcinoma - KIRC) that you can get as follows:<br>
1- ​go to FireBrowse (<a rel="nofollow" href="http://gdac.broadinstitute.org/%29">http://gdac.broadinstitute.org/)</a>, select “Kidney renal clear cell carcinoma” -&gt; “Browse”<br>
2- it should open a page with various data sets for KIRC<br>
3- from “mRNASeq” select “illuminahiseq_rnaseqv2-RSEM_genes_normalized” and save it on your computer<br>
4- from “Clinical” select “Merge_Clinical” and download it<br>
5- unzip the files by double clicking on them<br>
6- rename the folders as “RNA” and “Clinical”</p>

<p>now you can switch to R, you will need the package “survival” (<a rel="nofollow" href="https://cran.r-project.org/web/packages/survival/index.html">https://cran.r-project.org/web/packages/survival/index.html</a>)&nbsp;</p>

<pre># set directory to where the RNA and Clinical folders are
setwd(“/User/myUser/tutorial”)
library(survival)

# read RNA file 
rna &lt;- read.table("RNA/KIRC.rnaseqv2__illuminahiseq_rnaseqv2__unc_edu__Level_3__RSEM_genes_normalized__data.data.txt",nrows=20533, header=T,row.names=1,sep="\t")
# and take off first row cause we don’t need it
rna &lt;- rna[-1,]

# and read the Clinical file, in this case i transposed it to keep the clinical feature title as column name
clinical &lt;- t(read.table("Clinical/KIRC.merged_only_clinical_clin_format.txt",header=T, row.names=1, sep="\t"))

# first I remove genes whose expression is == 0 in more than 50% of the samples:
rem &lt;- function(x){
  x &lt;- as.matrix(x)
  x &lt;- t(apply(x,1,as.numeric))
  r &lt;- as.numeric(apply(x,1,function(i) sum(i == 0)))
  remove &lt;- which(r &gt; dim(x)[2]*0.5)
  return(remove)
}
remove &lt;- rem(rna)
rna &lt;- rna[-remove,]</pre>

<p>now I need to identify normal and tumor samples. this is done using the TCGA barcode (<a rel="nofollow" href="https://wiki.nci.nih.gov/display/TCGA/TCGA+barcode%29">https://wiki.nci.nih.gov/display/TCGA/TCGA+barcode)</a>. The two digits at position 14-15 of the barcode will indicate teh sample type, from the link:<br>
“Tumor types range from 01 - 09, normal types from 10 - 19 and control samples from 20 - 29.”</p>

<pre># see the values
table(substr(colnames(rna),14,14))
# 0      1 
# 534   72 </pre>

<p>so we haev 534 tumor and 72 normal</p>

<pre># get the index of the normal/control samples
n_index &lt;- which(substr(colnames(rna),14,14) == "1")
t_index &lt;- which(substr(colnames(rna),14,14) == "0")


# apply voom function from limma package to normalize the data
vm &lt;- function(x){
  cond &lt;- factor(ifelse(seq(1,dim(x)[2],1) %in% t_index, 1,  0))
  d &lt;- model.matrix(~1+cond)
  x &lt;- t(apply(x,1,as.numeric))
  ex &lt;- voom(x,d,plot=F)
  return(ex$E)
}

rna_vm  &lt;- vm(rna)
colnames(rna_vm) &lt;- gsub("\\.","-",substr(colnames(rna),1,12))


# and check how data look, they should look normally-ish distributed
hist(rna_vm)
# we can remove the old “rna” cause we don’t need it anymor
rm(rna)</pre>

<p>&nbsp;</p>

<p>now we&nbsp;can finally scale the data. the reason to do so is 
because we don’t want to use ONLY the fold changes. if we use FC then we
 average the expression values across all samples, losing the 
heterogeity that is characteristic of those data. we therefore transform
 data to z-score so that per each patient for each gene we will have a 
measure of how many SD away from the mean that is and we will consider 
those with Z &gt; +/- 1.96 (roughly p=0.05 or 2 SD away) to be 
differentially expressed</p>

<p>to obtain z-scores for the RNASeq data we use following formula:<br>
z = [(value gene X in tumor Y)-(mean gene X in normal)]/(standard deviation X in normal)</p>

<pre># calculate z-scores
scal &lt;- function(x,y){
  mean_n &lt;- rowMeans(y)  # mean of normal
  sd_n &lt;- apply(y,1,sd)  # SD of normal
  # z score as (value - mean normal)/SD normal
  res &lt;- matrix(nrow=nrow(x), ncol=ncol(x))
  colnames(res) &lt;- colnames(x)
  rownames(res) &lt;- rownames(x)
  for(i in 1:dim(x)[1]){
    for(j in 1:dim(x)[2]){
      res[i,j] &lt;- (x[i,j]-mean_n[i])/sd_n[i]
    }
  }
  return(res)
}
z_rna &lt;- scal(rna_vm[,t_index],rna_vm[,n_index])
# set the rownames keeping only gene name
rownames(z_rna) &lt;- sapply(rownames(z_rna), function(x) unlist(strsplit(x,"\\|"))[[1]])

rm(rna_vm) #we don’t need it anymore</pre>

<p>it might take some time, depending from your computer, be patient</p>

<p>now we can start using the clinical data</p>

<pre># match the patient ID in clinical data with the colnames of z_rna
clinical$IDs &lt;- toupper(clinical$patient.bcr_patient_barcode)
sum(clinical$IDs %in% colnames(z_rna)) # we have 529 patients that we could use

# get the columns that contain data we can use: days to death, new tumor event, last day contact to....
ind_keep &lt;- grep("days_to_new_tumor_event_after_initial_treatment",colnames(clinical))

# this is a bit tedious, since there are numerous follow ups, let's collapse them together and keep the first value (the higher one) if more than one is available
new_tum &lt;- as.matrix(clinical[,ind_keep])
new_tum_collapsed &lt;- c()
for (i in 1:dim(new_tum)[1]){
  if(sum(is.na(new_tum[i,])) &lt; dim(new_tum)[2]){
    m &lt;- min(new_tum[i,],na.rm=T)
    new_tum_collapsed &lt;- c(new_tum_collapsed,m)
  } else {
    new_tum_collapsed &lt;- c(new_tum_collapsed,"NA")
  }
}

# do the same to death
ind_keep &lt;- grep("days_to_death",colnames(clinical))
death &lt;- as.matrix(clinical[,ind_keep])
death_collapsed &lt;- c()
for (i in 1:dim(death)[1]){
  if(sum(is.na(death[i,])) &lt; dim(death)[2]){
    m &lt;- max(death[i,],na.rm=T)
    death_collapsed &lt;- c(death_collapsed,m)
  } else {
    death_collapsed &lt;- c(death_collapsed,"NA")
  }
}

# and days last follow up here we take the most recent which is the max number
ind_keep &lt;- grep("days_to_last_followup",colnames(clinical))
fl &lt;- as.matrix(clinical[,ind_keep])
fl_collapsed &lt;- c()
for (i in 1:dim(fl)[1]){
  if(sum(is.na(fl[i,])) &lt; dim(fl)[2]){
    m &lt;- max(fl[i,],na.rm=T)
    fl_collapsed &lt;- c(fl_collapsed,m)
  } else {
    fl_collapsed &lt;- c(fl_collapsed,"NA")
  }
}

# and put everything together
all_clin &lt;- data.frame(new_tum_collapsed,death_collapsed,fl_collapsed)
colnames(all_clin) &lt;- c("new_tumor_days", "death_days", "followUp_days")</pre>

<p>now, to do survival analysis we need three main things:<br>
1- time: this is the time till an event happens<br>
2- status: this indicates which patients have to be kept for the analysis<br>
3- event: this tells i.e. which patients have the gene up- or down-regulated or have no changes in expression</p>

<p>since we want to do censored analysis we need to have something to 
censor the data with. for example, if a patient has no death data BUT 
there is a date to last followup it means that after that day we know 
nothing about the patient, therefore after that day it cannot be used 
for calculations/Kaplan Meier plot anymore, therefore we censor it. so 
now we need to create vectors for both "time to new tumor" and 'time to 
death" that contain also the data from censored individuals</p>

<pre># create vector with time to new tumor containing data to censor for new_tumor
all_clin$new_time &lt;- c()
for (i in 1:length(as.numeric(as.character(all_clin$new_tumor_days)))){
  all_clin$new_time[i] &lt;- ifelse(is.na(as.numeric(as.character(all_clin$new_tumor_days))[i]),
                    as.numeric(as.character(all_clin$followUp_days))[i],as.numeric(as.character(all_clin$new_tumor_days))[i])
}

# create vector time to death containing values to censor for death
all_clin$new_death &lt;- c()
for (i in 1:length(as.numeric(as.character(all_clin$death_days)))){
  all_clin$new_death[i] &lt;- ifelse(is.na(as.numeric(as.character(all_clin$death_days))[i]),
                                 as.numeric(as.character(all_clin$followUp_days))[i],as.numeric(as.character(all_clin$death_days))[i])
}</pre>

<p>now we need to create the vector for censoring the data which means 
telling R which patients are dead or have new tumor. in this case if a 
patient has a “days_to_death” it will be assigned 1, and used in the 
corresponding analysis. the reason why we censor with death events even 
for recurrence is pretty important. a colleague made me notice that this
 is a competitive risk problem, where, although a patient can recur and 
then die, if a patient is dead, it will not recur, therefore is more 
accurate to censor for death events.</p>

<pre># create vector for death censoring
table(clinical$patient.vital_status)
# alive &nbsp;dead&nbsp;
#&nbsp;  372 &nbsp; 161&nbsp;

all_clin$death_event &lt;- ifelse(clinical$patient.vital_status == "alive", 0,1)

#finally add row.names to clinical
rownames(all_clin) &lt;- clinical$IDs</pre>

<p><br>
now one more thing to do is to use the z-score values we obtained from 
the RNASeq data and define which samples are altered or do not change in
 this case I just look at mRNA deregulation, you can divide the data 
into up- and down- regulated too if you wish</p>

<pre># create event vector for RNASeq data
event_rna &lt;- t(apply(z_rna, 1, function(x) ifelse(abs(x) &gt; 1.96,1,0)))

# since we need the same number of patients in both clinical and RNASeq data take the indices for the matching samples
ind_tum &lt;- which(unique(colnames(z_rna)) %in% rownames(all_clin))
ind_clin &lt;- which(rownames(all_clin) %in% colnames(z_rna))

# pick your gene of interest
ind_gene &lt;- which(rownames(z_rna) == "TP53")

# check how many altered samples we have
table(event_rna[ind_gene,])

# run survival analysis
s &lt;- survfit(Surv(as.numeric(as.character(all_clin$new_death))[ind_clin],all_clin$death_event[ind_clin])~event_rna[ind_gene,ind_tum])
s1 &lt;- tryCatch(survdiff(Surv(as.numeric(as.character(all_clin$new_death))[ind_clin],all_clin$death_event[ind_clin])~event_rna[ind_gene,ind_tum]), error = function(e) return(NA))

# extraect the p.value
pv &lt;- ifelse(is.na(s1),next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),3)))[[1]]

# plot the data
plot(survfit(Surv(as.numeric(as.character(all_clin$new_death))[ind_clin],all_clin$death_event[ind_clin])~event_rna[ind_gene,ind_tum]),
     col=c(1:3), frame=F, lwd=2,main=paste("KIRK",rownames(z_rna)[ind_gene],sep="\n"))

# add lines for the median survival
x1 &lt;- ifelse(is.na(as.numeric(summary(s)$table[,'median'][1])),"NA",as.numeric(summary(s)$table[,'median'][1]))
x2 &lt;- as.numeric(summary(s)$table[,'median'][2])
if(x1 != "NA" &amp; x2 != "NA"){
&nbsp; lines(c(0,x1),c(0.5,0.5),col="blue")
&nbsp; lines(c(x1,x1),c(0,0.5),col="black")
&nbsp; lines(c(x2,x2),c(0,0.5),col="red")
}

# add legend
legend(1800,0.995,legend=paste("p.value = ",pv[[1]],sep=""),bty="n",cex=1.4)
legend(max(as.numeric(as.character(all_clin$death_days)[ind_clin]),na.rm = T)*0.7,0.94,
       legend=c(paste("NotAltered=",x1),paste("Altered=",x2)),bty="n",cex=1.3,lwd=3,col=c("black","red"))</pre>

<p><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/TP53.png" alt="" style="height: 464px; width: 400px;"></p>

<p>now, the p.value in this case tells you that patients with altered TP53 have a worse survival…sad but true.<br>
the same concept can be applied to time to new tumor (new_time) (disease
 free survival, or DFS) and the resulting graph is the following:</p>

<p><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/DFS.png" alt="" style="height: 464px; width: 400px;"></p>

<p>this approach is very flexible, I leave to the reader the 
satisfaction to subset the events in up/downregulation and/or add 
covariates.</p>

<p>I know there are a number of different ways of doing this, hopefully 
this will be clear enought that the reader can replicate this.</p>

<p>lastly, thanks for getting till down here, comments, critiques, corrections etc are always welcome :)</p>

<p>#### UPDATES ####</p>

<p>- used voom transformation for RNASeq data</p>

<p>- created the death event vector based on the vital status from the clinical data</p>

<p>- updated code and images based on the results</p>

<p>- corrected the last <code>rna_log</code> variable (leftover from previous versions) to <code>rna_vm</code></p>

<p>- updated "min" to "max" for the "days_to_last_followup" based on cying comment</p>

<p>- updated "min" to "max" for the new_tumor and death</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
</span>


            <div class="clearfix">
                
                    <div class="tags clearfix" style="margin-bottom:0.5em;">
                        
                            <a class="tag" href="https://www.biostars.org/t/survival/">survival</a>
                        
                            <a class="tag" href="https://www.biostars.org/t/rna-seq/">rna-seq</a>
                        
                            <a class="tag" href="https://www.biostars.org/t/tcga/">tcga</a>
                        
                            <a class="tag" href="https://www.biostars.org/t/tutorial/">tutorial</a>
                        

                    • 15k views

                    </div>
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="153013" id="C153013">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/">link</a>
    

    
        
        •

        <div class="btn-group">
            <button type="button" class="btn btn-default btn-xs dropdown-toggle" id="F153013" data-toggle="dropdown">
                
                    Not following
                
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropup" role="menu">

                <li><a href="https://www.biostars.org/local/sub/153013/local/">Follow via messages</a></li>
                <li><a href="https://www.biostars.org/local/sub/153013/email/">Follow via email</a></li>
                <li><a href="https://www.biostars.org/local/sub/153013/nofollow/">Do not follow</a></li>
            </ul>
        </div>
    

    <span class="userlink muted">
            
            modified 1 hour ago
            
                by 


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b>
            
            •
        
        written <span itemprop="dateCreated" content="2015-08-03T00:26:31.363579-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="153113"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153113">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">3</div>
    </div>

   <p>I think this is a great tutorial, thanks for posting! &nbsp;</p>

<p>One thing I would add is to be careful of how you define a recurrence
 for the DFS data. &nbsp;While overall survival is rather 
straightforward, DFS can get complicated and is tumor dependent. 
&nbsp;For example, in head and neck cancer a patient is clinically 
classified as "WITH TUMOR" until the tests can be performed to verify 
the tumor is gone (which can be months from the original appointment). 
&nbsp;This can result in a "WITH TUMOR" classification in TCGA data for 
the first followup when really the patient was tumor free, they just 
haven't had the test done yet. &nbsp;Also, in HNSC tumors patients 
re-diagnosed with a tumor within 6 months of treatment completion it is 
considered part of the original tumor, not a new tumor, so it is 
residual tumor and not a recurrence. &nbsp;For HNSC at least (according 
to my expert collaborators) a re-diagnosed patient is considered to have
 a recurrence of the original tumor if it's between 6 months and 5 
years, and 5 years post-treatment it is considered a new primary tumor. 
&nbsp;Of course these may be different for each tumor type. &nbsp;So, if
 one is looking to publish survival plot for DFS I would urge them to 
talk to a specialist in the cancer type to get specific guidelines on 
what disease-free survival means, and then manually clean up the DFS 
time points and events before plotting using the treatment data as a 
guide.&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153113" id="C153113">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153113">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-03T11:51:07.996812-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/18428/">alolex</a> • <b>810</b>
    </span>
</div>


</div>
<div class="indent">

<a name="153118"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153118">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@alolex - thanks for the insightful feedback. you definitely make a
 valid point and I agree with you, the concept of DFS can be molded 
depending upon annotation accuracy/frequency and tumor type. and also, 
yes, before publishing any study on clinical data I would warmly suggest
 to talk to a clinician/statistician to make sure that the results make 
sense.</p>

<p>as for the KIRC data go, there is a "person_neoplasm_cancer_status" 
field that indicates whether the patient is "with tumor" or "tumor 
free". for the purpose of the tutorial I censored based on the presence 
of a "days_to_new_tumor_event" value but I agree it is more accurate to 
use the "with tumor" or "tumor free" indicators. I will update the code 
asap. thaks</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153118" id="C153118">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153118">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-03T12:15:20.058935-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
<div class="indent">

<a name="153135"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153135">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>@TriS thank you for this useful tutorial !</p>

<p>I think it would be better to change the lg2 function to:</p>

<pre>lg2 &lt;- function(x){
  x &lt;- as.matrix(x)
  x &lt;- t(apply(x,1,as.numeric))
  res &lt;- log2((x+1))
  return(res)
}</pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153135" id="C153135">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153135">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-03T14:16:20.101491-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/13773/">al3n70rn</a> • <b>90</b>
    </span>
</div>


</div>
<div class="indent">

<a name="153143"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153143">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@al3n70rn&nbsp;- thanks for the feedback, I'll change that. I was 
also looking into the VST transformation from DESeq2 which might even be
 a better choice. I'll add that asap<span style="background-color: rgb(239, 239, 239);">&nbsp;</span></p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153143" id="C153143">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153143">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-03T15:58:10.475480-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="153229"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153229">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@TriS - Do you have a github account? &nbsp;It might be a good 
idea to post this script there so people can easily download and make 
code change suggestions via Github.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153229" id="C153229">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153229">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-04T07:30:55.040446-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/18428/">alolex</a> • <b>810</b>
    </span>
</div>


</div>
<div class="indent">

<a name="153296"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="153296">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@alolex - that's a good idea ,thanks for the suggestion. I'll 
update the code this evening and then upload it on github as soon as I 
understand how that works.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="153296" id="C153296">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#153296">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-08-04T15:26:29.895894-05:00">
        18 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
</div>
</div>
<div class="indent">

<a name="165082"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165082">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>Great tutorial, Thanks!</p>

<p>I had a problem when using the TCGA BRCA data, the rnal_log is not 
being created. So downstream analysis is not performed. It seems the 
n_index and t_index are formed and also the voom function is fine.</p>

<p>Thanks a lot for your help!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165082" id="C165082">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165082">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-08T23:04:11.481938-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21731/">jyothipadiadpu</a> • <b>10</b>
    </span>
</div>


</div>
<div class="indent">

<a name="165213"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165213">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>that is actually a typo on my side, my apologies, it's the <code>rna_vm</code>, not <code>rna_log</code>, that's probably leftover from the first version i wrote, without adding the latest edits.</p>

<p>thanks for catching it, i'm gonna fix it now</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165213" id="C165213">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165213">link</a>
    

    

    <span class="userlink muted">
            
            modified 15 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2015-11-09T20:49:09.546426-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="165356"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165356">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>&nbsp;Great ! it worked now. Thanks a lot.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165356" id="C165356">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165356">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-11T00:10:47.690404-06:00">
        14 months ago</span> by 


<a href="https://www.biostars.org/u/21731/">jyothipadiadpu</a> • <b>10</b>
    </span>
</div>


</div>
</div>
</div>
</div>
<div class="indent">

<a name="165051"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165051">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Thank you so much for a great tutorial.</p>

<p>Sorry if these queries are a bit basic - probably need some more R learning!</p>

<p>Firstly, could I please ask how we would go about limiting this to, for example, five year overall survival?</p>

<p>Finally, how would I go about limiting the results to say just those who had radiotherapy (patient.radiation_therapy = yes)</p>

<p>Thanks again!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165051" id="C165051">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165051">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-08T08:25:58.828768-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21360/">jcfleming.ent</a> • <b>0</b>
    </span>
</div>


</div>
<div class="indent">

<a name="165466"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165466">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>there are a couple of things you could do.</p>

<p>1) keep the survival/follow up time only up to 5 years -&gt; 5(yrs)*365(days)=1825(days)</p>

<p>2) treatment data should be in the merged survival file, if not they 
are in one of the other files you can download. you need to create a 
dummy variable with therapy_yes=1 therapy_no=0 and select out only the 
patients with a 1..there are a million ways of selecting them out, this 
is just one of them.</p>

<p>3) last but most important, you might want to look up some basic 
survival analysis in R and how to extract subsets of data. this sounds 
basic but it's vital since it's what allows you to do things correctly 
and what you will &nbsp;refer to when you want to do a lil trickier 
analysis like the one you are asking&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165466" id="C165466">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165466">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-11T17:41:43.804869-06:00">
        14 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174088"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174088">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Please discard</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174088" id="C174088">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174088">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T15:46:56.797960-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="174089"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174089">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Please discard</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174089" id="C174089">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174089">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T15:46:56.832467-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
</div>
</div>
</div>
<div class="indent">

<a name="173893"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="173893">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>TriS Thank you so much for this tutorial. I found it very helpful.</p>

<p>I am interested in comparing the patients with overexpression of a 
gene and underexpression of that gene. To this end, I want to compare 
survival of patients with Z-score in the range &lt;-1.96, versus [-1,1] 
versus &gt; 1.96.</p>

<p>Is it correct to do the following?</p>

<pre>event_rna &lt;- t(apply(z_rna, 0, function(x) ifelse(x &gt; 1.96,2,ifelse(x &lt; -1.96,1,0)))) # for up and down regulated</pre>

<pre>&nbsp;</pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="173893" id="C173893">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#173893">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-24T14:54:19.141007-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
<div class="indent">

<a name="173901"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="173901">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>yes, that should work, however, the apply function you wrote has an error/typo, you need to use "1" to <a rel="nofollow" href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html">apply the function row by row</a></p>

<pre><span style="background-color: rgb(239, 239, 239);">event_rna &lt;- t(apply(z_rna, 1, function(x) ifelse(x &gt; 1.96,2,ifelse(x &lt; -1.96,1,0)))) </span></pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="173901" id="C173901">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#173901">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-24T16:12:04.252741-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174054"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174054">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@TriS Thank you so much!</p>

<p>&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174054" id="C174054">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174054">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-25T12:00:43.333937-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
</div>
</div>
</div>
<div class="indent">

<a name="174060"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174060">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Deleted the comment and instead put it as a new comment</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174060" id="C174060">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174060">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T12:18:42.781483-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="175787"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="175787">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi thanks for the great tutorial. &nbsp;Was there a particular 
reason you used the normalized gene count as opposed to the raw or 
scaled estimate? &nbsp;thank you!&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="175787" id="C175787">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#175787">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-05T19:41:13.385818-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/20112/">ahdee</a> • <b>0</b>
    </span>
</div>


</div>
<div class="indent">

<a name="175847"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="175847">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>yes and no. those data were available from Firehose but you can apply the same pipeline to other measurements i.e. raw counts</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="175847" id="C175847">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#175847">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-06T22:51:38.144060-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="176027"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="176027">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Thank you - reason why I ask is because I'm wondering what the 
reasoning behind using the the voom transformation? &nbsp;I would assume
 since the data is "normalized" wouldn't we be able to bypass this step?
 &nbsp; sorry I'm just trying to understand this a bit more so I'm 
wondering if you can elaborate on this a bit more. thanks</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="176027" id="C176027">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#176027">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-08T12:05:53.038496-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/20112/">ahdee</a> • <b>0</b>
    </span>
</div>


</div>
<div class="indent">

<a name="176865"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="176865">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>no probs, asking is good. you could use other transformations too.
 voom transformation is very practical and better than i.e. just taking 
the log2. <a rel="nofollow" href="https://seqqc.wordpress.com/2015/02/16/should-you-transform-rna-seq-data-log-vst-voom/">here</a>&nbsp;and <a rel="nofollow" href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-91">here</a>
 there are a few info about why voom is a good method + you can also use
 it with RPKM, which were the data available from TCGA. however, if you 
had raw counts you could have used DESEq2 to transform the data, for the
 sake of this tutorial and this analysis I don't think it will make a 
big difference (note: this should be tested!!). I do prefer to normalize
 because of the skeweness of the RNASeq/RPKM data which could inflate 
the actual differences between the different samples/genes.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="176865" id="C176865">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#176865">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-12T16:19:41.321779-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="176867"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="176867">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>you rock! thank you - btw you should put this on github. &nbsp;</p>

<p>&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="176867" id="C176867">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#176867">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-12T17:25:48.464255-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/20112/">ahdee</a> • <b>0</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="181317"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="181317">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>I am very new to this kind of analysis and try to do my first using your great tutorial. I took a look at this <a rel="nofollow" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiYnu68n7nLAhWLa3IKHQr3D-kQFggdMAA&amp;url=http%3A%2F%2Fgenomebiology.biomedcentral.com%2Farticles%2F10.1186%2Fgb-2014-15-2-r29&amp;usg=AFQjCNHxhvX7v_nJB6KopBa5ex_1WSKIkQ&amp;sig2=P7VAebWg2fn8zx5RaM5UGw">link</a>
 which I think is the paper introducing voom. It says that this method 
can be used with RPKM values, but RNAseq data you provided in this 
tutorial is normalized with RSEM method. Does this make any difference?</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="181317" id="C181317">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#181317">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-03-11T12:23:19.667077-06:00">
        10 months ago</span> by 


<a href="https://www.biostars.org/u/23628/">Vasei</a> • <b>10</b>
    </span>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
<div class="indent">

<a name="179182"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="179182">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi quick question.  Do you think it is better to eliminate the normal samples all together in the z-score calculations? </p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="179182" id="C179182">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#179182">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-02-29T12:31:37.397936-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/20112/">ahdee</a> • <b>0</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="192642"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="192642">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>link to the Firehouse should be updated</p>

<p>from</p>

<blockquote>
  <p><a rel="nofollow" href="http://gdac.broadinstitute.org/%29">http://gdac.broadinstitute.org/)</a></p>
</blockquote>

<p>to</p>

<blockquote>
  <p><a rel="nofollow" href="http://gdac.broadinstitute.org/">http://gdac.broadinstitute.org/</a></p>
</blockquote>

<p>excluding the closing paranthesis.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="192642" id="C192642">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#192642">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-05-20T04:42:55.360815-05:00">
        8 months ago</span> by 


<a href="https://www.biostars.org/u/6808/">bounlu</a> • <b>80</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="227249"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="227249">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Great post. I have several questions/feedback: </p>

<ol>
<li>Why did you use <code>KIRC.merged_only_clinical_clin_format.txt</code> instead of <code>KIRC.clin.merged.txt</code>?</li>
<li>There is a <code>Clinical_Pick_Tier1</code> file when you go to 
FireBrowse &gt; KIRC &gt; Clinical. Do you know what it is and how it is
 different than the one you used? I just checked the final numbers for <code>new_death</code> and they correspond to <code>days_to_death</code> (for event dead) and <code>days_to_last_followup</code> (for event alive) <em>combined</em> in the <code>Clinical_Pick_Tier1</code> file. If you use that file, you might save all the processing that you are doing to get the numbers for <code>new_death</code>. </li>
<li>Although the numbers for survival match, your <code>death_event</code> is  different than those given in the file (given as <code>vital_status</code>). I don't know how that file was processed so cannot comment on who is incorrect but wanted to put it out there.  </li>
<li>Why are you using <code>min</code> for <code>new_tum_collapsed</code> instead of <code>max</code> when you just want the highest value? </li>
<li>For each of the collapse methods, I had to convert the columns to numeric for e.g. <code>fl &lt;- apply(fl, 2, as.numeric)</code> otherwise I had character and factors which messed up the min/max values.</li>
</ol>

<p>Thanks!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="227249" id="C227249">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#227249">link</a>
    

    

    <span class="userlink muted">
            
            modified 7 weeks ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-12-14T11:08:48.733363-06:00">
        7 weeks ago</span> by 


<a href="https://www.biostars.org/u/7631/">komal.rathi</a> • <b>2.7k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="227661"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="227661">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <ol>
<li>you can use either, I just picked one. this tutorial is a guideline, not a rule</li>
<li>I didn't know that was available at the time of this tutorial, thank you for bringing that up, it is very useful</li>
<li>this post is almost a year and a half old, I would expect some differences in the events</li>
<li>because I took the time at which the first tumor re-appeared, not the last one</li>
<li>ok</li>
</ol>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="227661" id="C227661">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#227661">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-12-16T13:40:42.748540-06:00">
        6 weeks ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
<div class="indent">

<a name="231419"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="231419">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi, Tris</p>

<p>Thanks for the great tutorial. it is exactly what I want to do on 
colorectal cancer datasets. I'm an extreme newbie to bioinformatics, 
being able to run it on my dataset would be something big already. but I
 seem to have some difficulties in plotting median survival, when I run 
it on either your original dataset or the colorectal cancer dataset it 
gives me error message as follow:</p>

<blockquote>
  <p>x1 &lt;- ifelseis.na(as.numeric(summary(s)$table[,'median'][1])),"NA",as.numeric(summary(s)$table[,'median'][1]))
  x2 &lt;- as.numeric(summary(s)$table[,'median'][2])
  if(x1 != "NA" &amp; x2 != "NA"){
  +   lines(c(0,x1),c(0.5,0.5),col="blue")
  +   lines(c(x1,x1),c(0,0.5),col="black")
  +   lines(c(x2,x2),c(0,0.5),col="red")
  + }
  Error in if (x1 != "NA" &amp; x2 != "NA") { : 
    missing value where TRUE/FALSE needed</p>
</blockquote>

<p>Would you mind help me to look into this, if you get a chance? I truly have no idea of how to correct this.
Very much appreciated</p>

<p>Cheers,</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="231419" id="C231419">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#231419">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2017-01-12T18:02:37.953315-06:00">
        20 days ago</span> by 


<a href="https://www.biostars.org/u/36169/">tongtong.wang1210</a> • <b>0</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="231937"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="231937">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <pre class="pre language-bash"><code class=" language-bash">clinical <span class="token operator">&lt;</span>- t<span class="token punctuation">(</span>read.table<span class="token punctuation">(</span><span class="token string">"Clinical/BRCA.merged_only_clinical_clin_format.txt"</span>, header <span class="token operator">=</span> T, row.names <span class="token operator">=</span> 1, sep <span class="token operator">=</span> <span class="token string">"\t"</span><span class="token punctuation">))</span>
</code></pre>

<p>Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,  : </p>

<p>line 1141 did not have 1098 elements</p>

<p>What should I do for the above error?</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="231937" id="C231937">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#231937">link</a>
    

    

    <span class="userlink muted">
            
            modified 17 days ago
            
                by 


<a href="https://www.biostars.org/u/24526/">WouterDeCoster</a> ♦ <b>12k</b>
            
            •
        
        written <span itemprop="dateCreated" content="2017-01-16T02:38:58.564132-06:00">
        17 days ago</span> by 


<a href="https://www.biostars.org/u/36238/">ragsadhav</a> • <b>0</b>
    </span>
</div>


</div>
<div class="indent">

<a name="231938"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="231938">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>I moved your post to a comment (because it is no answer to the original thread).</p>

<p>Your 1141th line doesn't have the same number of elements (columns) 
as the rest of the file, so you should have a look at that line and see 
if something is odd. </p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token function">awk</span> <span class="token string">'NR==1141'</span> yourfile.txt
</code></pre>

<p>I'm not sure if the header is counted as a line by R, so perhaps you should also check the next line:</p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token function">awk</span> <span class="token string">'NR==1142'</span> yourfile.txt
</code></pre>

<p>and compare</p>

<p>Or is 1141/1142 the last line in your file containing whitespaces? <br>
Have a look at the number of lines:</p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token function">wc</span> -l yourfile.txt
</code></pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="231938" id="C231938">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#231938">link</a>
    

    

    <span class="userlink muted">
            
            modified 17 days ago
            
            •
        
        written <span itemprop="dateCreated" content="2017-01-16T02:45:02.085246-06:00">
        17 days ago</span> by 


<a href="https://www.biostars.org/u/24526/">WouterDeCoster</a> ♦ <b>12k</b>
    </span>
</div>


</div>
</div>
</div>
<div class="indent">

<a name="234622"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="234622">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>double post. Sorry, new to biostars. re-posted as "answer" below.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="234622" id="C234622">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#234622">link</a>
    

    

    <span class="userlink muted">
            
            modified 1 hour ago
            
            •
        
        written <span itemprop="dateCreated" content="2017-02-02T09:03:37.843759-06:00">
        1 hour ago</span> by 


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                </span>


                
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="162951">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">4</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="162951"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/21347/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/612bca272570476a67f119aeca41143b.png" alt="gravatar for gitarrestunden"></a></div>
        <div class="ago">15 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b></div>
        <div class="loc">Austria</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi!</p>

<p>Thank you for this tutorial!! I trid the KIRK dataset and overall, it worked great!</p>

<p>I had to change the following line because of an error:</p>

<p>clinical &lt;- t(read.table("Clinical/KIRC.merged_only_clinical_clin_format.txt",header=T, row.names=1, sep="\t"))</p>

<p>changed to:</p>

<p>clinical &lt;- read.table("Clinical/KIRC.merged_only_clinical_clin_format.txt",header=T, row.names=1, sep="\t")<br>
clinical &lt;- as.data.frame(t(clinical))</p>

<p>Reason:</p>

<pre><span style="background-color: rgb(225, 226, 229);">clinical$IDs &lt;- toupper(clinical$patient.bcr_patient_barcode)
Error in toupper(clinical$patient.bcr_patient_barcode) : 
  error in evaluating the argument 'x' in selecting a method for function 'toupper': Error in clinical$patient.bcr_patient_barcode : 
  $ operator is invalid for atomic vectors</span></pre>

<p>In addition, I get an error when I want to calculate p-values, however, I cant solve the problem:</p>

<pre><span style="background-color: rgb(225, 226, 229);">pv &lt;- ifelseis.na(s1),next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),3)))[[1]]
Error in ifelseis.na(s1), next, (round(1 - pchisq(s1$chisq, length(s1$n) -  : 
  error in evaluating the argument 'yes' in selecting a method for function 'ifelse': Error: no loop for break/next, jumping to top level</span></pre>

<p>Can someone help me to fix this?</p>

<p>Regards, G</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="162951" id="C162951">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#162951">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-22T07:48:56.593406-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="162954"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="162954">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Ok, got it, this one works:</p>

<pre><span style="background-color: rgb(225, 226, 229);">&gt; pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</span></pre>

<p>Regards, G</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="162954" id="C162954">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#162954">link</a>
    

    

    <span class="userlink muted">
            
            modified 15 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2015-10-22T08:12:42.534371-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b>
    </span>
</div>


</div>
<div class="indent">

<a name="162976"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="162976">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@<a rel="nofollow" href="https://www.biostars.org/u/21347/">gitarrestunden</a>&nbsp;-
 thanks for the feedback. I see a few issues in the code that you wrote,
 and that includes parenthesis and spaces between words. I'm not sure 
how the following line works since the parenthesis are off :</p>

<pre><span style="background-color: rgb(225, 226, 229);">pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</span></pre>

<p>and it should be more like :</p>

<pre><span style="background-color: rgb(225, 226, 229);">pv &lt;- ifelseis.na(s1), next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</span></pre>

<p>&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="162976" id="C162976">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#162976">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-22T11:02:20.742377-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="163086"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="163086">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Yes, I know what you mean, but the ifelse statement does not work 
in my system. I tried with correct parentheses and with or without 
commas/spaces...</p>

<pre><span style="background-color: rgb(225, 226, 229);">&gt; pv &lt;- ifelseis.na(s1)),next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]
Error: unexpected ',' in "pv &lt;- ifelseis.na(s1)),"</span></pre>

<p>This is the only working version on my system:</p>

<pre><span style="background-color: rgb(225, 226, 229);">&gt; pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</span></pre>

<p>Strange..</p>

<p>&nbsp;</p>

<p>&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="163086" id="C163086">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#163086">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-23T02:48:28.279819-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b>
    </span>
</div>


</div>
<div class="indent">

<a name="163087"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="163087">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>And it is also strange that the first parenthesis which should 
come directly after the "if" always disappears when I click the add 
comment button!!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="163087" id="C163087">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#163087">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-23T02:49:55.859063-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b>
    </span>
</div>


</div>
<div class="indent">

<a name="163476"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="163476">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>hmm...I wonder if there is a "lost" parenthesis somewhere else in your code</p>

<p>the <a rel="nofollow" href="http://www.inside-r.org/r-doc/base/ifelse">ifelse function</a> in R requires the commas and the reason why it tells you that there is an <code>unexpected ","</code> is because there is a parenthesis missing. the code you wrote is a one liner that sums up the formal if/else statements</p>

<p>for the parenthesis not showing up in the forum, I really have no idea :)</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="163476" id="C163476">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#163476">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-26T15:14:49.927230-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
</div>
<div class="indent">

<a name="229664"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="229664">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi Tris thank you for the tutorial, it is very useful. I get a 
similar error in generating p- value. Also some of the corrections made 
in the command line still shows an error. Can someone help fix this. 
Thank you in advance.</p>

<blockquote>
  <p>pv &lt;- ifelseis.na(s1),next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),3)))[[1]]</p>
</blockquote>

<p><strong>Error</strong> in ifelseis.na(s1), next, (round(1 - pchisq(s1$chisq, length(s1$n) -  : 
  no loop for break/next, jumping to top level</p>

<blockquote>
  <p>pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</p>
</blockquote>

<p><strong>Error</strong>: unexpected symbol in " pv &lt;- if is.na"</p>

<blockquote>
  <p>pv &lt;- ifelseis.na(s1), next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]</p>
</blockquote>

<p><strong>Error</strong>: unexpected ',' in "pv &lt;- ifelseis.na(s1),"</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="229664" id="C229664">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#229664">link</a>
    

    

    <span class="userlink muted">
            
            modified 4 weeks ago
            
            •
        
        written <span itemprop="dateCreated" content="2017-01-03T07:47:25.218120-06:00">
        4 weeks ago</span> by 


<a href="https://www.biostars.org/u/35937/">devi.jaganathan</a> • <b>0</b>
    </span>
</div>


</div>
<div class="indent">

<a name="229701"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="229701">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>it seems that there is a problem on the comment above where some brackets don't show up.</p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token function">pv</span> <span class="token operator">&lt;</span>- ifelse <span class="token punctuation">(</span> is.na<span class="token punctuation">(</span>s1<span class="token punctuation">)</span>,next,<span class="token punctuation">(</span>round<span class="token punctuation">(</span>1 - pchisq<span class="token punctuation">(</span>s1<span class="token variable">$chisq</span>, length<span class="token punctuation">(</span>s1<span class="token variable">$n</span><span class="token punctuation">)</span> - 1<span class="token punctuation">)</span>,3<span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="229701" id="C229701">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#229701">link</a>
    

    

    <span class="userlink muted">
            
            modified 4 weeks ago
            
            •
        
        written <span itemprop="dateCreated" content="2017-01-03T11:01:41.784775-06:00">
        4 weeks ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="230463"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="230463">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi Tris,
Thanks a lot for the correction.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="230463" id="C230463">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#230463">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2017-01-07T10:10:38.304322-06:00">
        26 days ago</span> by 


<a href="https://www.biostars.org/u/35937/">devi.jaganathan</a> • <b>0</b>
    </span>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="164952">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">1</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="164952"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/6532/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/d123a1c130b066d47babda34e3ea58f9.png" alt="gravatar for vibes1002003"></a></div>
        <div class="ago">15 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/6532/">vibes1002003</a> • <b>20</b></div>
        <div class="loc">Germany</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/6532/">vibes1002003</a> • <b>20</b> wrote:</div>
</div>

            <span itemprop="text"><p>I would like to know how can extend
 this code for survival analysis of multiple genes altogether or cancer 
subtypes ? &nbsp;I want to check effect of set of genes/ subtypes on 
survival probability through KM plot?</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="164952" id="C164952">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#164952">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-06T17:45:55.998245-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/6532/">vibes1002003</a> • <b>20</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="164955"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="164955">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>you should create a dummy variable in the survival analysis where you select patients with the gene signature altered</p>

<p>i.e. for genes A, B and C, you have a matrix m with row=genes, cols=patients:&nbsp;</p>

<pre>gene_sig &lt;- c(A,B,C)
rna_data_signature &lt;- rna_data[gene_sig,]
event_rna &lt;- apply(rna_data, 2, function(x) ifelse(sum(abs(x) &gt; 1.96 &gt;= 1),1,0))</pre>

<p>not tested but it should work. the idea is to use <code>apply</code> to select, by column, patients that have at least one gene in the signature altered</p>

<p>you can than use the <code>event_rna</code> vector in the survival analysis</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="164955" id="C164955">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#164955">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-06T18:40:52.771315-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="164964"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="164964">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>How can we make non-altered case since we need two groups -altered
 and unaltered for generating KM plot ? for instance you take 
those&nbsp;genes which are altered at least once in all the patients 
then how can we make unaltered case?&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="164964" id="C164964">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#164964">link</a>
    

    

    <span class="userlink muted">
            
            modified 15 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2015-11-06T21:35:26.359507-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/6532/">vibes1002003</a> • <b>20</b>
    </span>
</div>


</div>
<div class="indent">

<a name="165017"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="165017">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>if you look at the code I put in the answer, the patients with at 
least one alteration will be assigned a 1, if they have no alterations 
they will be assigned a zero. it basically checks column by column (= 
patient by patient) how many of those genes are altered, if the # of 
altered genes is &gt; 1, then they enter the "altered" group.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="165017" id="C165017">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#165017">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-07T17:28:35.772269-06:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="179081">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">1</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="179081"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/19163/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/04338a7961da99db76b3876ed1efb49c.png" alt="gravatar for cying"></a></div>
        <div class="ago">11 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b></div>
        <div class="loc">China</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, TriS. Your tutorial is very helpful.</p>

<p>I have done my own survival analysis using <a rel="nofollow" href="http://%28https//tcga-data.nci.nih.gov/tcgafiles/ftp_auth/distro_ftpusers/anonymous/tumor/kirc/bcr/nationwidechildrens.org/bio/clin/%29">clinical file before merged and cleaned</a>, but actually, the merge clinical file downloaded from the FireBrowse is more concise.
Here I list two questions:</p>

<ol>
<li><p>"days_to_last_followup", you said that get the minmum because the it's the latest number.But the definition of "<a rel="nofollow" href="https://tcga-data.nci.nih.gov/docs/dictionary/">days_to_last_followup</a>" is time interval from the date of last followup to the date of initial pathologic diagnosis,
which means the the longer days represent latest followups, so the days should take the maximum number.</p></li>
<li><p>to plot DFS survival curve, a vector contains censored or 
completed status should be created. In the merge clinical file, the 
column 
"patient.new_tumor_events.new_tumor_event_after_initial_treatment" 
defines the new tumor event status "yes", "no", or "NA".How to 
understand "NA" status? Does it mean the patient haven't occur new tumor
 event at the time of the last followup or  means haven't survey the new
 tumor event status at the time of the last followup? The variable "<code>all_clin$new_time</code>" in your code shows you have regarded the "NA" as "haven't occur new tumor event"(the same as status "no").Is that Right?</p></li>
</ol>

<p>Thanks.</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="179081" id="C179081">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#179081">link</a>
    

    

    <span class="userlink muted">
            
            modified 11 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-02-29T03:10:36.748211-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="179812"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="179812">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>hi cying, you made very good points and thank you for posting 
them.
1. yes, you are right! I overlooked the definition of "days to last 
followup" and you are correct, you should use the highest one. I will 
change the code accordingly
2. the NA in all_clin$new_time were counted as event that didn't happen,
 in this case no recurrence happened. to be honest I'm not sure about 
the difference between "no" and "NA" in 
"new_tumor_event_after_initial_treatement". i.e. there is an xls file 
for melanoma enrollment that annotates the field as 
<em>"Indicate whether the patient had a new tumor event (e.g. 
metastatic, recurrent, or new primary tumor) after the date of initial 
melanoma diagnosis. If the tumor that yielded the sample submitted for 
TCGA was a new tumor event (i.e. it was diagnosed after the initial 
diagnosis), the remaining questions should not be completed.
<strong>Please Note:If the patient did not have a new tumor event, the remaining questions can be skipped.</strong>"</em>
therefore when they annotate for no/NA they might indicate the same thing, and it actually depends from who annotates the data.
hope this helps!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="179812" id="C179812">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#179812">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-03-03T15:42:10.920402-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="179832"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="179832">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>That's a good point, maybe the the blank space of 
"new_tumor_event_after_initial_treatement" column is a hint of no new 
tumor events. Thanks!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="179832" id="C179832">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#179832">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-03-03T19:04:35.069441-06:00">
        11 months ago</span> by 


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b>
    </span>
</div>


</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="224555">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">1</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="224555"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/11529/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/572cada9f2d3871d4222402c4b016249.png" alt="gravatar for enxxx23"></a></div>
        <div class="ago">9 weeks ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/11529/">enxxx23</a> • <b>160</b></div>
        <div class="loc">Finland</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/11529/">enxxx23</a> • <b>160</b> wrote:</div>
</div>

            <span itemprop="text"><p>1) would be possible to get also the code which generates the DFS  plot also?</p>

<p>2) is there somewhere some cleaned up and up to date version of this code?</p>

<p>3) when running this code (and fixing myself some bugs which still 
has like for example adding "clinical = data.frame(clinical)" ) the 
KIRK-OS plot looks slightly different in the sense that I get NotAltered
 = NA and also I get a lot of warnings when computing all_clin$new_time 
,like for example, " In 
ifelseis.na(as.numeric(as.character(all_clin$new_tumor_days))[i]),  ... :
  NAs introduced by coercion"). Otherwise the plot looks similar. Is 
this normal?</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="224555" id="C224555">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#224555">link</a>
    

    

    <span class="userlink muted">
            
            modified 9 weeks ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-11-29T08:08:07.221672-06:00">
        9 weeks ago</span> by 


<a href="https://www.biostars.org/u/11529/">enxxx23</a> • <b>160</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="224574"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="224574">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>1) for the DFS plot you can use the DFS data in the clinical file.
2) no, the version here is what I had the time to create
3) you will get some warnings, if your code is correct these warnings come from the data and it's ok, some will be NA</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="224574" id="C224574">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#224574">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-11-29T09:19:21.919386-06:00">
        9 weeks ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="234620">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">1</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="234620"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/36718/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/b4c51dcd39863e4479173c4c34e039f1.png" alt="gravatar for JP"></a></div>
        <div class="ago">2 hours ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>error in post- sorry!</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="234620" id="C234620">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#234620">link</a>
    

    

    <span class="userlink muted">
            
            modified 1 hour ago
            
            •
        
        written <span itemprop="dateCreated" content="2017-02-02T08:50:04.006052-06:00">
        2 hours ago</span> by 


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="234624">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">1</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="234624"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/36718/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/b4c51dcd39863e4479173c4c34e039f1.png" alt="gravatar for JP"></a></div>
        <div class="ago">1 hour ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>thanks so much for the step-by-step tutorial, it has been very helpful for a biologist who is new to R and survival analysis.</p>

<p>I noticed that I am getting the following errors that don't allow for survfit() to function properly:</p>

<p><strong>Error #1:</strong></p>

<blockquote>
  <p>all_clin$new_death &lt;- c()
  for (i in 1:length(as.numeric(as.character(all_clin$death_days)))){
  +   all_clin$new_death[i] &lt;- 
ifelseis.na(as.numeric(as.character(all_clin$death_days))[i]),
  +                                   
as.numeric(as.character(all_clin$followUp_days))[i],as.numeric(as.character(all_clin$death_days))[i])

  + }</p>
</blockquote>

<p>Which gives me the following error:</p>

<pre class="pre language-bash"><code class=" language-bash">In ifelseis.na<span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>all_clin<span class="token variable">$death_days</span><span class="token punctuation">))</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>,  <span class="token punctuation">..</span>. <span class="token keyword">:</span>
</code></pre>

<p>NAs introduced by coercion</p>

<p>I read above that NAs shoudn't be a problem with this step, so I 
continued. However, when I get to the survfit function I get the second 
error</p>

<p><strong>Error #2:</strong></p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> s <span class="token operator">&lt;</span>- survfit<span class="token punctuation">(</span>Surv<span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>all_clin<span class="token variable">$new_death</span><span class="token punctuation">))</span><span class="token punctuation">[</span>ind_clin<span class="token punctuation">]</span>,all_clin<span class="token variable">$death_event</span><span class="token punctuation">[</span>ind_clin<span class="token punctuation">]</span><span class="token punctuation">)</span>~event_rna<span class="token punctuation">[</span>ind_gene,ind_tum<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>

<p>Error in Surv(as.numeric(as.character(all_clin$new_death))[ind_clin],  : 
  Invalid status value, must be logical or numeric</p>

<p>Any help with this would be greatly appreciate, and I am sorry in 
advance if I don't understand your response right away, as I said, I am 
very new to R and survival analysis.</p>

<p>Thanks again for the great tutorial!</p>

<p>JP</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="234624" id="C234624">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#234624">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2017-02-02T09:05:07.430341-06:00">
        1 hour ago</span> by 


<a href="https://www.biostars.org/u/36718/">JP</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="163470">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="163470"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/21444/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/be7602ef08d59f6dd4feefa7c1b2b2cd.png" alt="gravatar for nashtf"></a></div>
        <div class="ago">15 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/21444/">nashtf</a> • <b>0</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/21444/">nashtf</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>I tried running this with the BRCA data and get the following error on reading in the merged clinical data:</p>

<pre><span style="">clinical &lt;- t(read.table("Clinical/BRCA.merged_only_clinical_clin_format.txt",header=T,row.names=1,sep="\t"))</span>

Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  : 
  line 2 did not have 1099 elements</pre>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="163470" id="C163470">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#163470">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-26T14:44:03.239982-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21444/">nashtf</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="163475"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="163475">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">2</div>
    </div>

   <p>add&nbsp;</p>

<pre>quote="" </pre>

<p>to the <code>read.table()</code> function, that should fix it</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="163475" id="C163475">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#163475">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-26T15:10:05.921560-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="163530">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="163530"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/21347/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/612bca272570476a67f119aeca41143b.png" alt="gravatar for gitarrestunden"></a></div>
        <div class="ago">15 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b></div>
        <div class="loc">Austria</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi!</p>

<p>One last question: You wrote that "you can divide the data into up- and down- regulated too if you wish"</p>

<p>I guess i have to change this line, but I´m not sure how to do that correctly:</p>

<p>event_rna &lt;- t(apply(z_rna, 1, function(x) ifelse(abs(x) &gt; 1.96,1,0)))</p>

<p>&nbsp;</p>

<p>Thanks for help again!!</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="163530" id="C163530">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#163530">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-27T03:02:18.151012-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/21347/">gitarrestunden</a> • <b>40</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="163570"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="163570">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <pre>event_rna &lt;- t(apply(z_rna, 1, function(x) ifelse(x &gt; 1.96,1,ifelse(x &lt; -1.96,2,0))))</pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="163570" id="C163570">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#163570">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-10-27T08:38:20.997523-05:00">
        15 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="166077">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="166077"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/18624/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/6b8d75cfd2e46b5b94a0b41673b481ed.png" alt="gravatar for sunqiangzai"></a></div>
        <div class="ago">14 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/18624/">sunqiangzai</a> • <b>0</b></div>
        <div class="loc">China</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/18624/">sunqiangzai</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Great&nbsp;tutorial!I am curious 
about the number of the altered and not-altered group,since the number 
of patients are 529,why the altered group are so large?</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="166077" id="C166077">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#166077">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-16T23:51:06.165427-06:00">
        14 months ago</span> by 


<a href="https://www.biostars.org/u/18624/">sunqiangzai</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="166150"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="166150">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>I suppose you refer to the numbers in the legend. those are not 
the number of patients but the median survival in days in the altered 
and not altered groups. to get the months you can do (ndays/365)*12</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="166150" id="C166150">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#166150">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-11-17T09:38:20.544092-06:00">
        14 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="171228">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="171228"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/12112/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/d4e0c6ced7160325289bac815c9c4fb8.png" alt="gravatar for Palgrave"></a></div>
        <div class="ago">13 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/12112/">Palgrave</a> • <b>20</b></div>
        <div class="loc">Singapore</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/12112/">Palgrave</a> • <b>20</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi all, great tutorial.</p>

<p>I have two questions:</p>

<p>1) When calculating p-values I get this error, similar as above:</p>

<p>pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]&nbsp;&nbsp;&nbsp;&nbsp; #error<br>
Error: unexpected symbol in "pv &lt;- if is.na"</p>

<p>&nbsp;</p>

<p>2) Is there a method to find the relevant genes that are significant?</p>

<p>&nbsp;</p>

<p>Best wishes,</p>

<p>R</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="171228" id="C171228">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#171228">link</a>
    

    

    <span class="userlink muted">
            
            modified 13 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-02T03:26:21.119800-06:00">
        13 months ago</span> by 


<a href="https://www.biostars.org/u/12112/">Palgrave</a> • <b>20</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="171309"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="171309">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>1) When calculating p-values I get this error, similar as above:</p>

<pre>pv &lt;- if is.na(s1)) next else(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7))[[1]]     #error
Error: unexpected symbol in "pv &lt;- if is.na"</pre>

<p>your parenthesis are off, try this (not tested):</p>

<pre>pv &lt;- ifelse(is.na(s1),next,(round(1 - pchisq(s1$chisq, length(s1$n) - 1),7)))[[1]]</pre>

<p>2) Is there a method to find the relevant genes that are significant?</p>

<p>you mean differentially expressed genes? you might want to read a lil about <a rel="nofollow" href="https://www.biostars.org/p/107519/">z-scores</a> and <a rel="nofollow" href="https://www.biostars.org/p/11582/">differential gene expression analysis</a>&nbsp;or <a rel="nofollow" href="https://bioconductor.org/packages/release/bioc/html/limma.html">limma</a></p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="171309" id="C171309">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#171309">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-03T21:04:28.163694-06:00">
        13 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174375"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174375">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Is it possible to run through all my rownames and print all corresponding plots and p-values:</p>

<pre>ind_gene &lt;- which(rownames(z_rna) == "TP53")</pre>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174375" id="C174375">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174375">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-27T12:34:00.848466-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/12112/">Palgrave</a> • <b>20</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174422"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174422">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>yes, using <a rel="nofollow" href="https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r">for loops </a>and even writing it as a <a rel="nofollow" href="http://www.statmethods.net/management/userfunctions.html">function</a> :)</p>

<p>however, you might not want to print 15k to 30k plots, you might want to find a way to keep those you are interested in</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174422" id="C174422">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174422">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-27T19:08:58.437022-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174491"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174491">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Would you mind helping, I tried but got errors</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174491" id="C174491">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174491">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-28T07:52:15.597362-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/12112/">Palgrave</a> • <b>20</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174572"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174572">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>I'm going to give you a <em><strong>pseudocode </strong></em>that you can apply to your analysis:</p>

<pre>for 1 to # of genes
  run survival analysis
  extract p.value
  if p.value is significant &amp; some other conditions
    plot the graph</pre>

<p>...learning how to code does come with LOTS of trial and error, it's 
good that you got errors cause it can show you what you did wrong.</p>

<p>also, your question then becomes more general on the lines of "how to
 apply a function to multiple genes", which can be 1) googled 2) posted 
on the general forum since it's not specific anymore to this tutorial</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174572" id="C174572">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174572">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-28T14:10:25.570001-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="174062">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="174062"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/2844/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/798f7bef05add1d02c4d514c3af92ea6.png" alt="gravatar for Les Ander"></a></div>
        <div class="ago">12 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b> wrote:</div>
</div>

            <span itemprop="text"><p>When I use the GBM data and the TP53, I get an error in the vm function (at the&nbsp;&nbsp; &nbsp;</p>

<pre>    d &lt;- model.matrix(~1+cond)  </pre>

<p>step.</p>

<p>The error message is</p>

<pre>   Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : 
      contrasts can be applied only to factors with 2 or more levels
   Called from: `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]])</pre>

<p>&nbsp;</p>

<p>Any idea how to fix this?</p>

<p>Thanks</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="174062" id="C174062">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#174062">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T12:21:36.174724-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="174573"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174573">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>can you check that the <code>n_index </code>and <code>t_index </code>are not empty? also that <code>cond </code>does contain data?</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174573" id="C174573">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174573">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-28T14:12:45.156195-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="174064">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="174064"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/2844/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/798f7bef05add1d02c4d514c3af92ea6.png" alt="gravatar for Les Ander"></a></div>
        <div class="ago">12 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b> wrote:</div>
</div>

            <span itemprop="text"><p>The histogram of z-scores is not 
quite symmetric, it tends to have a heavier tail on the lower end (i.e. 
there are more genes below summit) so it does not look like that &gt; 
1.96 is equivalent to p=0.05 (my guess is that it is much lower than 
that. Similarly, I don't think that the Z &lt; -1.96 is p=0.05 either 
(my guess is that it is much higher than that). Any suggestions how to 
deal with such asymmetric distribution? My inclination would be to use 
percentiles i.e. top 10% of the data versus bottom 10% of the data. 
However, I am not sure how to modify the code to do that. Any 
suggestions would be much appreciated.</p>

<p>I think the change has to be something like below but not sure if it is correct:</p>

<pre>pr_thresh=quantile(z_rna, c(0.1, 0.9))</pre>

<pre>LOWTHRESH=pr_thresh[1]
HIGHTHRESH=pr_thresh[2]</pre>

<pre><span style="background-color: rgb(239, 239, 239);">event_rna &lt;- t(apply(z_rna, 1, function(x) ifelse(x &gt; HIGHTHRESH,2,ifelse(x &lt; -LOWTHRESH,1,0)))) </span></pre>

<p>Any thoughts on the use of percentiles and/or on the implementation?</p>

<p>Thanks</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="174064" id="C174064">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#174064">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T12:52:09.009376-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="174066"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174066">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>the data won't always be perfectly symmetric, you can cut your 
data so that you have the same number of patients in each side in order 
to balance it out when doing survival analysis. however, when we are 
talking about hundreds of patients, small differences in n do not cause 
issues. some statisticians here use even z=+/-1.5 as long as it gives 
them symmetric/even groups.</p>

<p>the 1.96 threshold is not a must, cBioportal uses 2, you can use what
 you prefer and what fits your needs as long as there is a rationale 
behind it. also, the z scores here are calculated comparing T to N so 
you won't perfectly center the data around 0 as if you would scale the 
data within the same sample group.</p>

<p>for percentile you can use the top 10/20 etc...I'm not aware of a 
hard threshold, the important thing, as above, is that you have an 
explanation of why you pick that # (although rarely you read one in 
papers :)).</p>

<p>lastly, if you are worried about data being skewed, you can also 
calculate skeweness of the data in R and evaluate in in that way. a 
value +/- 3 is a no go...but I don't think you will get anywhere close 
to it with the Z scores from this tutorial</p>

<p>hope this helps!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174066" id="C174066">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174066">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-25T13:20:26.794716-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="174072"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174072">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>@TriS, Thank you for the explanation!</p>

<p>&nbsp;</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174072" id="C174072">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174072">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-25T14:04:58.952501-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


</div>
</div>
</div>
<div class="indent">

<a name="196234"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="196234">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>hi,
I'm wondering if you used 10% threshold above, how to plot survival 
curve with only those two lines (&gt; HIGHTHRESH vs &lt; -LOWTHRESH).
thanks</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="196234" id="C196234">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#196234">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-11T21:19:37.060085-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="174105">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="174105"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/2844/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/798f7bef05add1d02c4d514c3af92ea6.png" alt="gravatar for Les Ander"></a></div>
        <div class="ago">12 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b> wrote:</div>
</div>

            <span itemprop="text"><p>I am interested in looking only upto 5 years (1825 days).</p>

<p>I'm new to survival analysis.</p>

<p>Is it correct to discard all the samples whose max(days_to_last_known_alive, days_to_last_followup) is &lt;=1825</p>

<p>by doing this:</p>

<pre>    all_clin=all_clin[all_clin$new_death &lt;= 1825,] </pre>

<p>Is this correct? (I have a feeling that it is not because I am simply
 throwing away patient data who have lived beyond 5 years). If the above
 approach is not correct, can you please tell me what is the right way 
to do it?</p>

<p>Thanks</p>

<p>&nbsp;</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="174105" id="C174105">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#174105">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-01-25T16:58:08.644125-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/2844/">Les Ander</a> • <b>80</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="174122"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="174122">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>code seems fine to me but&nbsp;I'm a lil confused...you want to 
look up to 5 years but then you don't want to throw away patients that 
have lived beyond 5 years...if you decide a threshold that'll be applied
 to both living and deceased patients and you will get a snapshot of 
what happened up to that point in time.</p>

<p>as a general suggestion, look up some stuff on survival analysis and 
data subsetting. although I'm glad to see that this tutorial helps, it 
gives the basis on how to do it and it can be much more useful when you 
can grasp the concepts behind <a rel="nofollow" href="https://www.google.com/search?q=survival+anaysis+in+r&amp;oq=survival+anaysis+in+r&amp;aqs=chrome..69i57j0l5.2310j0j7&amp;sourceid=chrome&amp;es_sm=119&amp;ie=UTF-8#q=censored+survival+analysis+in+r&amp;search_plus_one=form">censored survival analysis</a> and how/why to do it and tweak it to your needs</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="174122" id="C174122">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#174122">link</a>
    

    

    <span class="userlink muted">
            
            modified 12 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-01-25T23:07:00.888369-06:00">
        12 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="196054">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="196054"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/23838/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/72e880a4b767a76b29bbb1fd2a942b5c.png" alt="gravatar for ShirleyDai"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b> wrote:</div>
</div>

            <span itemprop="text"><p>This tutorial is really helpful to 
me.
Can you give some scripts on how to perform comparison like 
"Up-regulated" vs "Down-regulated"? It would be better to add plot and 
legend functions.
I tried to mask all event_rna==0 as NA (event_rna was coded same as in 
your script) and then remove them. But I found most genes were removed, 
including my interested gene.</p>

<p>Thanks</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="196054" id="C196054">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#196054">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-10T11:11:56.710591-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="196134"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="196134">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">2</div>
    </div>

   <p>You need a bit modification in above script:</p>

<p>library(survival)</p>

<p>z_rna (expression normalized data)</p>

<p>clinical data</p>

<p>then you have to calculate median of your gene</p>

<p>median(z_rna$yourgene)</p>

<p>rna_event &lt;- ifelse(z_rna$yourgene &gt;= (median), 1,0)     ## 1,0 ;  up &amp; downregulated class</p>

<p>then follow similar above code...</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="196134" id="C196134">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#196134">link</a>
    

    

    <span class="userlink muted">
            
            modified 7 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-06-10T17:56:14.915354-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/24365/">Mike</a> • <b>450</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="196231">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="196231"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/23838/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/72e880a4b767a76b29bbb1fd2a942b5c.png" alt="gravatar for ShirleyDai"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi,
I have a quick question about z-score you used. 
"mean gene X in normal" was used as "mean expression in diploid samples" in your script.
Then should I only inquire paired tumor and normal samples in the TCGA data portal?</p>

<p>Thanks </p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="196231" id="C196231">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#196231">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-11T20:00:26.468582-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="196253"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="196253">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count">1</div>
    </div>

   <p>Check following related post:</p>

<p><a rel="nofollow" href="https://www.biostars.org/p/107519/">TCGA: What are mRNA expression z-scores? Does TCGA have mRNA expression from controls?</a></p>

<p><a rel="nofollow" href="https://groups.google.com/forum/#%21topic/cbioportal/Wq8kt2nJ6S8">https://groups.google.com/forum/#!topic/cbioportal/Wq8kt2nJ6S8</a></p>

<p><a rel="nofollow" href="https://www.biostars.org/p/121150/">TCGA survival analysis with z-scores all samples altered</a></p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="196253" id="C196253">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#196253">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-12T03:40:53.793883-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/24365/">Mike</a> • <b>450</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="197231">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="197231"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/28133/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/d9e7d0a305dd50466cd752861fd0cf91.png" alt="gravatar for zsucllj"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, thank you very much for your 
tutorials
I have a quick question.  I want to divide the tumor patients into two 
groups based on their mRNA expression (X gene) and then evaluate whether
 X gene mRNA expression level has any correlation with survival. Would 
you kindly tell me how to write the script? Thanks a lot : )</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="197231" id="C197231">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#197231">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-16T17:38:14.609422-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="197238"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="197238">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>See my question above. Mike gave the exact answer and related script.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="197238" id="C197238">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#197238">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-16T20:10:29.670368-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/23838/">ShirleyDai</a> • <b>20</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="197856">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="197856"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/22782/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/7ce51be1f5b07317312d1ab6f7797c15.png" alt="gravatar for biostata"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/22782/">biostata</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/22782/">biostata</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>The error message is</p>

<p>clinical$IDs &lt;- toupper(clinical$patient.bcr_patient_barcode)</p>

<p>Error in clinical$patient.bcr_patient_barcode : 
  $ operator is invalid for atomic vectors</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="197856" id="C197856">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#197856">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-21T03:08:15.093525-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/22782/">biostata</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="199362">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="199362"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/28133/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/d9e7d0a305dd50466cd752861fd0cf91.png" alt="gravatar for zsucllj"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, Should I make any changes to 
the above script? because I am just interested in the cancer patients 
but not the normal controls? Thanks!</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="199362" id="C199362">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#199362">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-29T12:16:09.712246-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="199379"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="199379">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>For this you need to further filter out samples from TCGA barcode ,
 tumor types range from 01 - 09,  normal types from 10 - 19 Control 
samples from 20 - 29, <a rel="nofollow" href="https://wiki.nci.nih.gov/display/TCGA/Working+with+TCGA+Data">https://wiki.nci.nih.gov/display/TCGA/Working+with+TCGA+Data</a>.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="199379" id="C199379">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#199379">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-29T13:32:22.024601-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/24365/">Mike</a> • <b>450</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="199418">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="199418"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/28133/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/d9e7d0a305dd50466cd752861fd0cf91.png" alt="gravatar for zsucllj"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, Thank you very much for your 
help.Would you kindly tell me why the tumor types in this script are 
marked as 14? They should be 01-09. Thanks!  </p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="199418" id="C199418">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#199418">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-29T16:42:31.722173-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/28133/">zsucllj</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="199470"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="199470">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Hi  zsucllj,</p>

<p>in this script 14 is not tumor types/sample, this is the two digits 
at position 14-15 of the barcode (eg.  TCGA-02-0001-01 , including "-"),
 </p>

<p>plase have a look at figure &amp; table (<a rel="nofollow" href="https://wiki.nci.nih.gov/display/TCGA/Working+with+TCGA+Data">https://wiki.nci.nih.gov/display/TCGA/Working+with+TCGA+Data</a>)</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="199470" id="C199470">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#199470">link</a>
    

    

    <span class="userlink muted">
            
            modified 7 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-06-30T02:50:25.169506-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/24365/">Mike</a> • <b>450</b>
    </span>
</div>


</div>
</div>
<div class="indent">

<a name="199533"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="199533">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>if you are replying to the same question please use the "add comment" link :)</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="199533" id="C199533">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#199533">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-06-30T09:03:08.413987-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="199546"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="199546">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>sorry TriS, I dont know whats different b/w "add comment"  and 
"add reply".  if my comments are not according to proper format , please
 delete them.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="199546" id="C199546">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#199546">link</a>
    

    

    <span class="userlink muted">
            
            modified 7 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-06-30T09:54:28.876906-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/24365/">Mike</a> • <b>450</b>
    </span>
</div>


</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="200297">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="200297"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/28893/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/e6d6eb0ffc6fe260f0ba406648a3db1c.png" alt="gravatar for jzhou"></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b></div>
        <div class="loc">USA, California</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, thank you very much for an 
informative tutorial!
I apologize if this is an overly naive question, but I was wondering 
what new things could be learned from conducting your own survival 
analysis of TCGA data like in this tutorial when on Firehose there are 
already analyses of nearly every TCGA cancer data set including 
correlations between mRNAseq data and survival rates in their "Clinical 
Analysis" pages. Thanks!</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="200297" id="C200297">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#200297">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-07-05T19:49:29.834788-05:00">
        7 months ago</span> by 


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="204687"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="204687">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>When I look at correlations to survival with Firehose I find that 
they often list 0 genes correlating with survival.  In contrast to their
 analysis, I have found thousands of genes that have significant 
p-values.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="204687" id="C204687">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#204687">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-08-01T23:23:38.535527-05:00">
        6 months ago</span> by 


<a href="https://www.biostars.org/u/24017/">Jordan Anaya</a> • <b>640</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="202116">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="202116"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/19056/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/f1bb810570f48350d9d95fd63c5cb09f.png" alt="gravatar for biobiu"></a></div>
        <div class="ago">6 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/19056/">biobiu</a> • <b>0</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/19056/">biobiu</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, 
Great tutorial and thank you very much!
I have some further comments and questions:</p>

<p>1) If someone is willing to get another/additional data from other 
sources, it is very important that the patients in "new_death", 
"death_event" and in the "rna event" will be in the same order in all of
 them (in this tutorial its unnecessary since all the data is sorted by 
the same way in gdac).</p>

<p>2) How can it be that some patients have a value which is not NA in 
the death_days data, but in patient.vital_status is "alive" (e.g 
TCGA-A3-3347, or TCGA-A3-3325), in both cases 
patient.follow_ups.follow_up.vital_status shows "dead" but 
patient.vital_status shows "alive", however it seems to me as a bug in 
the updated data uploaded to gdac. 
what do you think? 
Do you understand what is the difference between patient.vital_status to
 patient.follow_ups.follow_up.vital_status? 
If you will agree that this is kind of a bug, I suggest the following 
correction:</p>

<p>all_clin$death_event &lt;- ifelse(all_clin$death_days =="NA" , 0,1)</p>

<p>instead of:
all_clin$death_event &lt;- ifelse(clinical$patient.vital_status == "alive", 0,1)</p>

<p>3) Just to make sure- 
 1)the reason that you got NA in the median survival is because that 
most of them are still alive?
 2) Is the figure is up to date? because things are a bit difference 
(mean survival for altered is now 3554, for not altered is the same, the
 gdac data was upadated, do you believe that is the case?).</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="202116" id="C202116">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#202116">link</a>
    

    

    <span class="userlink muted">
            
            modified 6 months ago
            
            •
        
        written <span itemprop="dateCreated" content="2016-07-17T10:19:47.890853-05:00">
        6 months ago</span> by 


<a href="https://www.biostars.org/u/19056/">biobiu</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="204686"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="204686">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>I program mainly in Python so I haven't tried running the code in 
this thread, but a patient vital status issue was raised recently for 
OncoLnc: <a rel="nofollow" href="https://github.com/OmnesRes/onco_lnc/issues/1">https://github.com/OmnesRes/onco_lnc/issues/1</a></p>

<p>In this repository you will find Python code for extracting clinical 
data from files downloaded from the old TCGA data portal which were 
named "clinical_follow_up" and "clinical_patient".</p>

<p>For OncoLnc I had to parse the clinical data for 21 different 
cancers, and most of the time in the files when a patient is 'dead' they
 have '[Not Applicable]' written in the 'last_contact_days_to' column, 
but in some cancers and for some patients they list a number in that 
column even when a patient is dead.</p>

<p>Given that this issue was most prevalent for GBM and OV and I believe
 those are two of the earlier studies performed by TCGA I can't help but
 wonder if TCGA changed how they report the follow_up times at some 
point and this resulted in an inconsistent file format.</p>

<p>To answer your point 3 I did notice that I would get 'NA' for median 
survival when I had more patients listed as 'alive' and once I fixed the
 code I had much fewer 'NA' values for median survival.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="204686" id="C204686">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#204686">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-08-01T23:20:22.369442-05:00">
        6 months ago</span> by 


<a href="https://www.biostars.org/u/24017/">Jordan Anaya</a> • <b>640</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="205315">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="205315"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/27841/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/1d8b489a3495fe7cfef2d915f6df2492.png" alt="gravatar for sharmi.banerji"></a></div>
        <div class="ago">6 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/27841/">sharmi.banerji</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/27841/">sharmi.banerji</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hello,</p>

<p>I have a question on the legend. I used this script in similar 
analysis except that I have a status column indication "altered" and 
"not altered". I was wondering if I use </p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token comment" spellcheck="true"># plot the data</span>
 plot<span class="token punctuation">(</span>survfit<span class="token punctuation">(</span>Surv<span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>all_clin<span class="token variable">$new_death</span><span class="token punctuation">))</span><span class="token punctuation">[</span>ind_clin<span class="token punctuation">]</span>,all_clin<span class="token variable">$death_event</span><span class="token punctuation">[</span>ind_clin<span class="token punctuation">]</span><span class="token punctuation">)</span>~event_rna<span class="token punctuation">[</span>ind_gene,ind_tum<span class="token punctuation">]</span><span class="token punctuation">)</span>,
 col<span class="token operator">=</span>c<span class="token punctuation">(</span>1:3<span class="token punctuation">)</span>, frame<span class="token operator">=</span>F, lwd<span class="token operator">=</span>2,main<span class="token operator">=</span>paste<span class="token punctuation">(</span><span class="token string">"KIRK"</span>,rownames<span class="token punctuation">(</span>z_rna<span class="token punctuation">)</span><span class="token punctuation">[</span>ind_gene<span class="token punctuation">]</span>,sep<span class="token operator">=</span><span class="token string">"\n"</span><span class="token punctuation">))</span>
</code></pre>

<p>that means the color of the graph will be black for "altered" and red
 for "not altered" (as per order of the factors). But doesn't  manually 
adding the legend like this </p>

<pre class="pre language-bash"><code class=" language-bash"><span class="token comment" spellcheck="true"># add legend</span>
legend<span class="token operator">=</span>c<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"NotAltered="</span>,x1<span class="token punctuation">)</span>,paste<span class="token punctuation">(</span><span class="token string">"Altered="</span>,x2<span class="token punctuation">))</span>,bty<span class="token operator">=</span><span class="token string">"n"</span>,cex<span class="token operator">=</span>1.3,lwd<span class="token operator">=</span>3,col<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"black"</span>,<span class="token string">"red"</span><span class="token punctuation">))</span>
</code></pre>

<p>swaps the legends of the two graphs? Or maybe I am missing something here.</p>

<p>Greatly appreciate help!</p>

<p>Thanks</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="205315" id="C205315">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#205315">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-08-04T11:39:48.242383-05:00">
        6 months ago</span> by 


<a href="https://www.biostars.org/u/27841/">sharmi.banerji</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="209804">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="209804"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/18669/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/ee12b2596b1488f286609938136fcb55.png" alt="gravatar for lazymaggie"></a></div>
        <div class="ago">5 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/18669/">lazymaggie</a> • <b>0</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/18669/">lazymaggie</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>I feel something is wrong in your codes:</p>

<p>ind_tum &lt;- which(unique(colnames(z_rna)) %in% rownames(all_clin))</p>

<p>ind_clin &lt;- which(rownames(all_clin) %in% colnames(z_rna))</p>

<p>the patient's barcodes are not matched using the two ids:</p>

<p>rownames(all_clin)[ind_clin]</p>

<p>colnames(event_rna)[ind_tum]</p>

<p>both all_clin and event_rna have duplicated samples, so a solution about the above problem is using the following codes:</p>

<p>all_clin &lt;- all_clin[!duplicated(rownames(all_clin)), ]  # remove duplicated samples in all_clin</p>

<p>event_rna &lt;- event_rna[, !duplicated(colnames(event_rna))] # remove duplicated samples in event_rna</p>

<p>commonId &lt;- intersect(colnames(event_rna), rownames(all_clin))  # obtain the common samples</p>

<p>ind_tum &lt;- which(colnames(event_rna) %in% commonId) </p>

<p>ind_clin &lt;- which(rownames(all_clin) %in% commonId)</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="209804" id="C209804">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#209804">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-08-31T14:17:12.608607-05:00">
        5 months ago</span> by 


<a href="https://www.biostars.org/u/18669/">lazymaggie</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="214097"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="214097">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>lazymaggie, thank you for pointing this out. I will check the code and edit where necessary</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="214097" id="C214097">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#214097">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-09-28T20:15:56.764368-05:00">
        4 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="214603">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="214603"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/23063/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/2973fe7ddd6ad42bbd6044c58ba732f2.png" alt="gravatar for charco"></a></div>
        <div class="ago">4 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/23063/">charco</a> • <b>30</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/23063/">charco</a> • <b>30</b> wrote:</div>
</div>

            <span itemprop="text"><p>Thanks for writing this up.</p>

<p>A question about the input data however.
I thought that illuminahiseq_rnaseqv2-RSEM_genes_normalized was not RPKM
 (or more correctly FPKM for paired end data), but actually a quantile 
normalised raw count provided by RSEM (see here <a rel="nofollow" href="https://wiki.nci.nih.gov/display/TCGA/RNASeq+Version+2%29">https://wiki.nci.nih.gov/display/TCGA/RNASeq+Version+2)</a>.</p>

<p>It would be important not to confuse the two.</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="214603" id="C214603">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#214603">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-03T01:28:11.562439-05:00">
        4 months ago</span> by 


<a href="https://www.biostars.org/u/23063/">charco</a> • <b>30</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="214731"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="214731">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>it doesn't really matter in this case since they'll be transformed to zscores</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="214731" id="C214731">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#214731">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-03T13:44:04.810707-05:00">
        4 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="214883"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="214883">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>So which one is it?</p>

<p>Maybe it doesn't make a difference for your workflow, but it may do 
for others.
For example, using voom on quantile normalised data may not be optimal.
Also, if someone was performing downstream analyses that aggregated data
 across genes (eg gene set enrichment), you wouldn't want them to think 
they were using RPKM when they were actually using counts.</p>

<p>It is worth noting for the many people (including students) reading 
this thread who may go on to perform a variety of another analyses. 
Please consider correcting your description of the input data (if there 
is an error?).</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="214883" id="C214883">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#214883">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-04T07:15:42.543136-05:00">
        4 months ago</span> by 


<a href="https://www.biostars.org/u/23063/">charco</a> • <b>30</b>
    </span>
</div>


</div>
<div class="indent">

<a name="214905"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="214905">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>firebrowse (the file I suggested) provides you with RSEM values, 
not FPKM, not RPKM. 
for data normalization there are multiple ways of normalizing them and 
it depends from what you want to do. for the scope of this tutorial voom
 works well.
if you prefer other methods DESeq2 or edgeR offer different flavors that
 might better fit your needs.
also, bare in mind that what I described is a guide, not the only way of
 doing it. </p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="214905" id="C214905">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#214905">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-04T08:01:06.528437-05:00">
        4 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
<div class="indent">

<a name="216163"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="216163">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Are you sure?
The file you suggested has 'normalized count' written in the header.
RSEM gives transcripts per million (TPM) by default, which is not the same as a normalized count</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="216163" id="C216163">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#216163">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-11T07:54:15.594359-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/23063/">charco</a> • <b>30</b>
    </span>
</div>


</div>
<div class="indent">

<a name="216292"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="216292">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>so, the normalized values are RSEM data divided by the 75th 
percentile and multiplied by 1000, as you correctly pointed out in the 
fist comment. to get TPM you have to multiply the RSEM estimate for 10^6
 (<a rel="nofollow" href="http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-323">RSEM paper</a>)
in this case, those are normalized RSEM values, not TPM, not RPKM, not FPKM.
hope this helps</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="216292" id="C216292">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#216292">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-11T18:06:41.924625-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="218425">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="218425"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/28893/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/e6d6eb0ffc6fe260f0ba406648a3db1c.png" alt="gravatar for jzhou"></a></div>
        <div class="ago">3 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b></div>
        <div class="loc">USA, California</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, thanks again for a great 
tutorial. This might be a very basic question, but I was wondering if 
anyone could tell me what the numbers for Altered and NotAltered exactly
 refer to? Thanks!</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="218425" id="C218425">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#218425">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-23T15:54:47.704401-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/28893/">jzhou</a> • <b>10</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="218566"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="218566">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>number of samples with gene expression higher/lower than a specific threshold (i.e. z-score of 2) -&gt; altered
opposite -&gt; not altered</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="218566" id="C218566">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#218566">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-24T11:12:54.174892-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="218897">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="218897"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/19163/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/04338a7961da99db76b3876ed1efb49c.png" alt="gravatar for cying"></a></div>
        <div class="ago">3 months ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b></div>
        <div class="loc">China</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, in regard to the 
"days_to_new_tumor_event_after_initial_treatment", I think the smaller 
value was more reasonable than the higher one. The DFS was defined as 
the time from initial treatment until the date of new tumor event. And 
the first time of new tumor event should be selected instead of the last
 time. This was opposite to the "days of last follow-up".</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="218897" id="C218897">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#218897">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-26T01:26:36.520428-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/19163/">cying</a> • <b>10</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="219016"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="219016">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>hi cying, thank you for spotting that, you are correct. 
this code went through several updates, and that's one of those I didn't implement yet.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="219016" id="C219016">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#219016">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2016-10-26T11:33:23.484388-05:00">
        3 months ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                
                    <span itemscope="" itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="230829">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="vote" title="" data-original-title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top" data-type="bookmark" title="" data-original-title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="230829"></a>
        
        <div class="content">

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="https://www.biostars.org/u/36089/"><img src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/5e3716a5315f46cef7a4f29cc39ab596.png" alt="gravatar for 352182595"></a></div>
        <div class="ago">23 days ago by</div>
        <div class="uname">


<a href="https://www.biostars.org/u/36089/">352182595</a> • <b>0</b></div>
        <div class="loc"></div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="https://www.biostars.org/u/36089/">352182595</a> • <b>0</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hi, thanks for your great tutorial.
Could you help me a question about survival analysis.In clinical, i want
 to updata survival function in a dynamic way but lack of multiple gene 
values to fit such a longitudinal model,so i want to use <strong>landmark approach</strong>
 to update the prognosis.However, i am not sure whether a genomic 
variable is a time-varying effect covariate,which means the effect of 
the gene might vary with time.
Thank you for your patience,and hope that  you could share me more 
detailes.</p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="230829" id="C230829">ADD COMMENT</span>

    • <a href="https://www.biostars.org/p/153013/#230829">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2017-01-10T05:41:26.584406-06:00">
        23 days ago</span> by 


<a href="https://www.biostars.org/u/36089/">352182595</a> • <b>0</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="230906"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="230906">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>this question goes beyond what's described in this tutorial, you should start a new question in Biostar for that.</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="230906" id="C230906">ADD REPLY</span>

    • <a href="https://www.biostars.org/p/153013/#230906">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2017-01-10T10:12:49.084787-06:00">
        23 days ago</span> by 


<a href="https://www.biostars.org/u/13278/">TriS</a> • <b>2.4k</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                

                
                <span id="csrf_token"><input name="csrfmiddlewaretoken" value="ep6RwTnfoS2dOg0GA4TdH3DSWBgcvrFH" type="hidden"></span>

                
                <div>

                    

                    
                    

                    
                    

                    
                    
                        <div class="form-group">
                        <h3>Add your answer</h3>

                        <div class="alert alert-success">

                            <p><strong>Note:</strong> Answers should ONLY be used to respond to the original question at the
                                top of this page!
                            </p>

                            <p>
                                Use the <span class="label label-default add-comment">ADD COMMENT</span> or
                                <span class="label label-default add-comment">ADD REPLY</span> buttons above to
                                respond to someone, ask for clarifications, request more details etc,
                                </p>
                        </div>

                        <form role="form" id="answer-form" method="post" action="/p/new/answer/153013/">
                            <input name="csrfmiddlewaretoken" value="ep6RwTnfoS2dOg0GA4TdH3DSWBgcvrFH" type="hidden">
                            <div class="">
    <div class="wmd-panel">
        <div id="wmd-button-bar"><ul id="wmd-button-row" class="wmd-button-row"><li class="wmd-button" style="left: 0px;" id="wmd-bold-button" title="Strong &lt;strong&gt; Ctrl+B"><span style="background-position: 0px 0px;"></span></li><li class="wmd-button" style="left: 25px;" id="wmd-italic-button" title="Emphasis &lt;em&gt; Ctrl+I"><span style="background-position: -20px 0px;"></span></li><li class="wmd-spacer wmd-spacer1" id="wmd-spacer1"></li><li class="wmd-button" style="left: 75px;" id="wmd-link-button" title="Hyperlink &lt;a&gt; Ctrl+L"><span style="background-position: -40px 0px;"></span></li><li class="wmd-button" style="left: 100px;" id="wmd-quote-button" title="Blockquote &lt;blockquote&gt; Ctrl+Q"><span style="background-position: -60px 0px;"></span></li><li class="wmd-button" style="left: 125px;" id="wmd-code-button" title="Code Sample &lt;pre&gt;&lt;code&gt; Ctrl+K"><span style="background-position: -80px 0px;"></span></li><li class="wmd-button" style="left: 150px;" id="wmd-image-button" title="Image &lt;img&gt; Ctrl+G"><span style="background-position: -100px 0px;"></span></li><li class="wmd-spacer wmd-spacer2" id="wmd-spacer2"></li><li class="wmd-button" style="left: 200px;" id="wmd-olist-button" title="Numbered List &lt;ol&gt; Ctrl+O"><span style="background-position: -120px 0px;"></span></li><li class="wmd-button" style="left: 225px;" id="wmd-ulist-button" title="Bulleted List &lt;ul&gt; Ctrl+U"><span style="background-position: -140px 0px;"></span></li><li class="wmd-button" style="left: 250px;" id="wmd-heading-button" title="Heading &lt;h1&gt;/&lt;h2&gt; Ctrl+H"><span style="background-position: -160px 0px;"></span></li><li class="wmd-button" style="left: 275px;" id="wmd-hr-button" title="Horizontal Rule &lt;hr&gt; Ctrl+R"><span style="background-position: -180px 0px;"></span></li><li class="wmd-spacer wmd-spacer3" id="wmd-spacer3"></li><li class="wmd-button" style="left: 325px;" id="wmd-undo-button" title="Undo - Ctrl+Z"><span style="background-position: -200px -20px;"></span></li><li class="wmd-button" style="left: 350px;" id="wmd-redo-button" title="Redo - Ctrl+Shift+Z"><span style="background-position: -220px -20px;"></span></li></ul></div>
         <textarea class="wmd-input" id="wmd-input" name="content" rows="15" placeholder="Type your post here"></textarea>
    </div>
</div>

<div>
    <div id="wmd-preview" class="wmd-panel wmd-preview"></div>
</div>

                            <input name="submit" value="Submit Answer" class="btn btn-primary" id="submit-id-submit" type="submit">

                        </form>
                        </div>
                    
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-3 sidebar">
            
                <h4>Similar posts • <a href="https://www.biostars.org/local/search/page/">Search »</a></h4>

                

                <ul class="more-like-this">
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/213401/">How to apply a function to a list and get results as a list in R? </a>

                                    <div class="peek">I'd like to run the below code for my table, but instead of defining "ind_gene" as a single row n...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/66304/">Survival Analysis - No(Non-Missing) Observations </a>

                                    <div class="peek">Hi,

I am having a  problem with my code.  I am working with 5 datasets, 4 of them work fine with...</div>
                                </li>
                            
                        
                        
                            

                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/212811/">DESeq2 paired analysis  </a>

                                    <div class="peek">Hey guys, 

I am new to DESeq2 and I am trying to following a template on https://gist.github.com...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/230428/">survival analysis using R </a>

                                    <div class="peek">I want to add censored data info on my plot how to I do that

&amp;gt;try_surv &amp;lt;- survfit(Surv(Sur...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/141992/">Can Limma package be used for RNA-Seq Differential gene expression analysis for Quantile normalized log transformed RPKM data </a>

                                    <div class="peek">Hello All,

I have retrieved the data matrix from TCGA breast invasive carcinoma (BRCA) – express...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/103871/">Parsing ./spoNA.xml file failed, please check the file! </a>

                                    <div class="peek">I am trying the pathway analysis from this workflow (1). I recieve error that parsing some file f...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/179077/">Guide to TCGA data </a>

                                    <div class="peek">Guide to TCGA data
==================

Hi, I've been working with TCGA data for a couple years no...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/125770/">published array data not replicable with limma analysis </a>

                                    <div class="peek">hi all

I'm a bit battled since I'm re-analyzing some published data from a collaborator and I ca...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/195213/">Signature genes from RNA-seq time series (Developmental)  </a>

                                    <div class="peek">Hi,

I have a time series data in tripicates for 4 time points. My aim is to identify signature g...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="https://www.biostars.org/p/99849/">Is this edgeR code fine? </a>

                                    <div class="peek">Hi guys,

I would you to revise my edgeR code since it's possible I missed something important be...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                </ul>
            
        </div>
    </div>
    <script src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/prism.js" type="text/javascript"></script>



    
    
        <div class="row">
            <div class="col-sm-12 col-md-12">
                <hr>
            </div>
        </div>

        <div class="row toc">

            <div class="col-xs-3 col-xs-offset-1 col-md-2 col-md-offset-3">
                <div class="title">Content</div>
                <ul class="flat">
                    <li><a href="https://www.biostars.org/local/search/page/">Search</a></li>
                    <li><a href="https://www.biostars.org/user/list/">Users</a></li>
                    <li><a href="https://www.biostars.org/t/">Tags</a></li>
                    <li><a href="https://www.biostars.org/b/list/">Badges</a></li>
                </ul>
            </div>

            <div class="col-xs-3 col-md-2">
                <div class="title">Help</div>
                <ul class="flat">
                    <li><a href="https://www.biostars.org/info/about/">About</a></li>
                    <li><a href="https://www.biostars.org/info/faq/">FAQ</a></li>
                </ul>
            </div>

            <div class="col-xs-3 col-md-2 ">
                <div class="title">Access</div>
                <ul class="flat">
                    <li><a href="https://www.biostars.org/info/rss/">RSS</a></li>
                    <li>Stats</li>
                    <li><a href="https://www.biostars.org/info/api/">API</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <hr>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center">
                Use of this site constitutes acceptance of our <a href="https://www.biostars.org/info/policy/">User
                Agreement
                and Privacy
                Policy</a>.
            </div>
            <div class="col-md-12 text-center">
                Powered by <a href="https://github.com/ialbert/biostar-central">Biostar</a>
                version 2.3.0
            </div>
        </div>
    

    
    <div id="traffic">Traffic: 1683 users visited in the last hour</div>

 	<div style="margin-top:2em" align="center">
    <iframe style="background:transparent !important" scrolling="no" allowtransparency="true" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/a.html" width="300" height="300" frameborder="0"></iframe><script type="text/javascript" src="Survival%20analysis%20of%20TCGA%20patients%20integrating%20gene%20expression%20%28RNASeq%29%20data_files/6.js" async="async"></script>
</div>

</div>



    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-101522-12']);
        _gaq.push(['_setDomainName', 'biostars.org']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>


</body></html>